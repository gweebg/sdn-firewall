reset_state
table_set_default ipv4_lpm drop
table_set_default dst_mac drop
table_set_default src_mac drop


table_add ipv4_lpm ipv4_fwd 10.0.1.10/24 => 10.0.1.10 1
table_add ipv4_lpm ipv4_fwd 10.0.1.20/24 => 10.0.1.20 1
table_add ipv4_lpm ipv4_fwd 10.0.1.100/24 => 10.0.1.100 1
table_add ipv4_lpm ipv4_fwd 10.0.2.0/24 => 10.0.2.1 2
table_add ipv4_lpm ipv4_fwd 10.0.3.0/24 => 10.0.3.1 3


table_add src_mac rewrite_src_mac 1 => 00:00:00:01:01:01
table_add src_mac rewrite_src_mac 2 => 00:00:00:01:01:02
table_add src_mac rewrite_src_mac 3 => 00:00:00:01:01:03


table_add dst_mac rewrite_dst_mac 10.0.1.10 => 00:00:00:02:00:03
table_add dst_mac rewrite_dst_mac 10.0.1.20 => 00:00:00:02:00:02
table_add dst_mac rewrite_dst_mac 10.0.1.100 => 00:00:00:02:00:01
table_add dst_mac rewrite_dst_mac 10.0.2.1 => 00:00:00:01:02:02
table_add dst_mac rewrite_dst_mac 10.0.3.1 => 00:00:00:01:03:03

table_add fwall_rules RulesSuccess 10.0.1.0&&&255.255.255.0 10.0.2.10&&&255.255.255.255 0x06 80 1 1

table_add fwall_rules RulesSuccess 10.0.1.0&&&255.255.255.0 10.0.3.10&&&255.255.255.255 0x06 8080 1 1