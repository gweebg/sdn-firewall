reset_state
table_set_default ipv4_lpm drop
table_add ipv4_lpm ipv4_fwd 10.1.0.1/24 => 10.1.0.1 1
table_add ipv4_lpm ipv4_fwd 10.2.0.1/24 => 10.2.0.1 2
table_add ipv4_lpm ipv4_fwd 10.3.0.10/32 => 10.3.0.10 3
table_add ipv4_lpm ipv4_fwd 10.3.0.20/32 => 10.3.0.20 3
table_add ipv4_lpm ipv4_fwd 10.3.0.100/32 => 10.3.0.100 3
table_add ipv4_lpm ipv4_fwd 10.4.0.1/24 => 10.4.0.1 1

table_set_default src_mac drop
table_add src_mac rewrite_src_mac 1 => 00:00:00:01:03:01
table_add src_mac rewrite_src_mac 2 => 00:00:00:01:03:02
table_add src_mac rewrite_src_mac 3 => 00:00:00:01:03:03

table_set_default dst_mac drop
table_add dst_mac rewrite_dst_mac 10.1.0.1 => 00:00:00:01:01:03
table_add dst_mac rewrite_dst_mac 10.2.0.1 => 00:00:00:01:02:03
table_add dst_mac rewrite_dst_mac 10.3.0.10 => 00:00:00:02:04:01
table_add dst_mac rewrite_dst_mac 10.3.0.20 => 00:00:00:02:05:01
table_add dst_mac rewrite_dst_mac 10.3.0.100 => 00:00:00:02:06:01
table_add dst_mac rewrite_dst_mac 10.4.0.1 => 00:00:00:01:01:03

table_add MyIngress.checkPacketDirection setPacketDirection 10.3.0.0&&&255.255.255.0 10.0.0.0&&&0.0.0.0 => 1 1
table_add MyIngress.checkPacketDirection setPacketDirection  10.0.0.0&&&0.0.0.0 10.3.0.0&&&255.255.255.0 => 2 1
table_add MyIngress.checkPacketDirection setPacketDirection  10.0.0.0&&&0.0.0.0 10.0.0.0&&&0.0.0.0 => 3 1

table_set_default fwall drop
table_add fwall_rules RulesSuccess 10.1.0.0&&&255.255.255.0 10.3.0.10&&&255.255.255.255 0x06 8080 1 1
table_add fwall_rules RulesSuccess 10.2.0.0&&&255.255.255.0 10.3.0.20&&&255.255.255.255 0x06 443 1 1
